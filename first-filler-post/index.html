<!DOCTYPE html> <html lang="ru"> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title> Импорт ми бейби уан мор тайм &bull; iwouldnot's blog </title> <meta name="description" content="Снова здрасьте."> <link rel="stylesheet" href="/css/main.css"> <link rel="canonical" href="https://iwouldnot.me/first-filler-post/"> <link rel="alternate" type="application/rss+xml" title="iwouldnot's blog" href="https://iwouldnot.me/feed.xml" /> <script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-105831298-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script> </head> <body class="single"> <main class="main"> <header class="header"> <div class="overlay"> <div class="container"> <h1 class="title"> <a href="/">iwouldnot's blog</a> </h1> <nav class="navbar"> <a href="#" class="menu-icon"> <span></span> <span></span> <span></span> </a> <ul class="nav"> <li><a href="https://github.com/iwouldnot/iwouldnot.github.io" target="_blank">github</a></li> </ul> </nav> </div> </div> </header> <article class="post container card"> <header class="post-header"> <h1 class="post-title">Импорт ми бейби уан мор тайм</h1> <span class="post-meta"> <time class="post-date" datetime="2017-08-29">Aug 29, 2017</time> <span class="post-author">by Ivan Vaniushin</span> </span> </header> <div class="post-content"> <p>Снова здрасьте.</p> <p>Ну мне же надо что-то написать.</p> <p>Сделаю вид, как будто я вас учу импортировать библиотеки под ML.</p> <p>(Анализ частотных рядов — как-нибудь в другой раз, уж извините)</p> <p>Это пусть тут побудет, а вы смотрите и учитесь. Импортирую я как боженька, да-да. Собственно, это мои импорты с последней построенной модельки для регрессии длины входящего звонка. Как бы моделька не особо большая, так что и импорты довольно скромные. Но не особо шарящих людей уже вполне себе может впечатлить. Такие дела.</p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">catboost</span> <span class="kn">import</span> <span class="n">Pool</span><span class="p">,</span> <span class="n">CatBoostClassifier</span><span class="p">,</span> <span class="n">CatBoostRegressor</span><span class="p">,</span> <span class="n">cv</span><span class="p">,</span> <span class="n">CatboostIpythonWidget</span>
<span class="kn">import</span> <span class="nn">hyperopt</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span><span class="p">,</span> <span class="n">cross_val_score</span><span class="p">,</span> <span class="n">StratifiedKFold</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">RFECV</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestClassifier</span><span class="p">,</span> <span class="n">RandomForestRegressor</span><span class="p">,</span> <span class="n">GradientBoostingRegressor</span>

<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="kn">as</span> <span class="nn">sns</span></code></pre></div> <p>Ну ладно, ладно. Вот вам ещё немного кода.</p> <p>Это пересчет суммы звонка от одного и того же абонента за определенный временной промежуток (window).</p> <div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;id_abonent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">target_rows</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;id_abonent&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span>
    <span class="n">temp_df</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">target_rows</span><span class="p">]</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s">&#39;id_abonent&#39;</span><span class="p">])</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">temp_df</span><span class="p">[</span><span class="s">&#39;call_start&#39;</span><span class="p">])</span>
    <span class="n">temp</span><span class="p">[</span><span class="s">&#39;called_lately&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">temp</span><span class="p">[</span><span class="s">&#39;called_lately&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="s">&#39;4h&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s">&#39;call_start&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">called_lately</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">target_rows</span><span class="p">,</span> <span class="s">&#39;called_lately&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="p">[</span><span class="s">&#39;called_lately&#39;</span><span class="p">]</span></code></pre></div> <p>Ну и хватит с вас.</p> <aside class="share"> <span>Share this: </span> <a href="http://twitter.com/share?text=Импорт ми бейби уан мор тайм&amp;url=https://iwouldnot.me/first-filler-post/&amp;hashtags=web,dev,blog,soudev&amp;via=nandomoreirame" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;"> <i class="fa fa-twitter-square"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?u=https://iwouldnot.me/first-filler-post/" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;"> <i class="fa fa-facebook-square"></i> </a> </aside> <hr> <aside id="comments" class="disqus"> <h2 class="txt-center">Comments</h2> <div id="disqus_thread"></div> <script type="text/javascript"> var disqus_shortname = 'iwdnot-blog'; var disqus_url = 'https://iwouldnot.me/first-filler-post/'; var disqus_identifier = '/first-filler-post'; var disqus_title = 'Импорт ми бейби уан мор тайм'; /* disqus_developer = 1; */ (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); </script> <noscript> Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a> </noscript> </aside> </div> </article> <footer class="footer t-center"> <div class="container"> <div class="social-icons"> <ul class="text-left"> <li><a href="https://vk.com/iwouldnot" target="_blank"><i class="fa fa-vk"></i></a></li> <li><a href="https://t.me/iwouldnot" target="_blank"><i class="fa fa-telegram"></i></a></li> </ul> </div> <small>&copy; 2017 All rights reserved.</small> </div> </footer> </main> </body> </html></body></html>
